# 脚手架

1，⼴义上来说，脚手架就是为了保证各实施过程顺利进行而搭建的工作平台

2，编程领域的脚⼿架主要为了完成新项⽬的启动和搭建，能够帮助开发者提升效率和开发体验。

## 问答

## 要点

### 命令⾏⼯具原理和实现

1，开发命令⾏⼯具的关键依赖：

- inquirer、enquirer、prompts：可以处理复杂的⽤户输⼊，完成命令⾏输⼊交互。
- chalk、kleur：使终端可以输出彩⾊信息⽂案。
- ora：可以让命令⾏出现好看的 Spinners。
- boxen：可以在命令⾏中画出 Boxes 区块。
- listr：可以在命令⾏中画出进度列表。
- meow、arg：可以进⾏基础的命令⾏参数解析。
- commander、yargs：可以进⾏更加复杂的命令⾏参数解析。

2，使⽤ ncp 包实现跨平台递归拷⻉⽂件，使⽤ chalk 做个性化输出

3，需要完成 git 的初始化以及依赖安装⼯作

- execa：允许开发中使⽤类似 git 的外部命令。
- pkg-install：使⽤ yarn install 或 npm install 安装依赖。
- listr：给出当前进度 progress

4，另外⼀种做法是将模板单独维护到⼀个 GitHub 仓库当中。在创建⼀个项⽬时，我们使⽤ download-git-repo 来下载模板

### 从命令⾏到万能脚⼿架

1，使⽤命令⾏启动并创建⼀个基于模板的项⽬只能说是⼀个脚⼿架的雏形，们还需要从可伸缩性、⽤户友好性⽅⾯考虑：

- 如何使模板⽀持版本管理
- 模板如何进⾏扩展
- 如何进⾏版本检查和更新
- 如何⾃定义构建

2，模板⽀持版本管理可以使⽤ npm 维护模板，这样借助 npm 的版本管理，我们可以天然地⽀持不同版本的模板。当然在脚⼿架的设计中，要加⼊对版本的选择和处理。

3，模板扩展可以借助中⼼化⼿段，集成开发者⼒量，提供模板市场。这⾥需要注意的是，**针对不同模板或功能区块的可插拔性是⾮常重要的**

4，所有这些⽂件的⽣成过程都需要可插拔，更理想的是，这些插件是⼀个独⽴的运⾏时。因此我们可以将每⼀个脚⼿架⽂件（即模板⽂件）的初始化视作⼀个独⽴的应⽤，由命令⾏统⼀指挥调度

## 知识点

1，npm 6.1 及以上版本，我们都可以使⽤ npm init 或 yarn create 来启动我们的项⽬，⽐如下⾯两个命令就是等价的：

```sh
npm init @fujia/project

yarn create @fujia/project
```

2，构建是⼀个⽼⼤难问题，不同项⽬的构建需求是不同的。不同构建脚本可以考虑单独抽象，提供可插拔式封装。⽐如 jslib-base 这个库的设计，这也是⼀个“万能脚⼿架”

## 小结

1，实现⼀个企业级脚⼿架需要不断打磨和优化，不断增强⽤户体验和可操作性，⽐如处理边界情况、终端提示等

2，更重要的是，对构建逻辑的抽象和封装，根据业务需求，不断扩展命令和模板。
