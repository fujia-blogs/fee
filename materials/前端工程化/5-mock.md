# 接口调试

## Mock

1. 定义：

- Mock 在程序设计中是指使⽤模拟（Mock）的对象来替代真实对象，以测试其他对象的⾏为。
- 在前端开发流程中，我们说的 Mock 通常是指模拟数据（俗称假数据）以及⽣成和使⽤模拟数据的⼯具与流程。

2. 为什么需要 mock？

在⼀个前后端分离的项⽬开发流程中，项⽬的开发时间通常分为三块：前端开发时间 t1，后端开发时间 t2，前后端联调时间 t3。理想情况下，整体的项⽬开发时间是 <=max（t1，t2）+t3，即前后端同时开发，两端都开发完成后进⼊联调。甚⾄再进⼀步，为了提⾼效率，也可以将整个开发流程按功能点进⾏更细粒度地拆分，即在开发时间内，也可以在部分功能开发完成后⽴即进⾏这⼀部分的联调，以期望利⽤碎⽚化的时间来减少后期完整联调的时间。

### 选择 mock 方案的考量标准

1. 实现路径：

- 可以直接在代码中侵⼊式地书写静态返回数据来调试相关逻辑。
- 可以使⽤后端开发服务作为 Mock 服务，将未实现的功能在后端返回 Mock 数据。
- 可以通过⼀些本地 Mock ⼯具，使⽤项⽬本地化的 Mock 规则⽂件来⽣成 Mock 数据。
- 可以使⽤功能更丰富的接⼝管理⼯具来提供独⽴的 Mock 能⼒。

2. mock 方案选择的参考依据：

- **仿真度：** Mock 数据作为实际前后端调⽤时的数据模拟，需要在接⼝定义上尽可能与后端实际提供接⼝的各⽅⾯保持⼀致。从接⼝名称、调⽤⽅法、请求头信息到返回头信息，返回值字段⼀致性越⾼，在后期切换到联调实际接⼝时花费的时间越短。因此，使⽤ Mock 数据前，需要使前后端在事先对接⼝的定义上达成⼀致。因此，数据定义的仿真度是决定实际模拟过程效率和质量的⾸要因素。
- **易⽤性：**在定义完接⼝⽂档之后，下⼀步是⽣成 Mock 数据。通常⼀个⾼效的 Mock ⼯具需要具备将接⼝⽂档⾃动转换为 Mock 接⼝的能⼒。接⼝⽂档作为前后端联调的⼀致性保证，当接⼝发⽣任何变化时都会⾸先更新到⽂档中，并⾃动反映到提供的 Mock 数据中。同样，后端提供的真实服务也应当完整通过 Mock 接⼝的测试，⽽这种⾃动输出 Mock 数据，以及⾃动测试接⼝的能⼒也是**整个 Mock ⽅案易⽤性的考量标准之⼀。**
- **灵活性：**通常来说，实际的接⼝调⽤中我们会根据不同的调⽤⽅式与传⼊参数等条件来输出不同的返回值，前端根据不同条件下返回值的差异做不同的交互处理。因此，在使⽤ Mock ⼯具的过程中，对不同条件下返回不同数据的 Mock 期望能⼒也是我们选择 Mock ⽅案的考虑点。

## 主流的 mock 工具

### mock.js

1. Mock.js 是前端领域流⾏的 Mock 数据⽣成⼯具之⼀，后续许多功能更丰富的⼯具和系统在各⾃的 Mock 功能部分都将它作为基础设施。

2. Mock.js 的核⼼能⼒是定义了两类⽣成模拟数据的规范：

- **数据模板定义规范(Data Template Definition, DTD)**
- **数据占位符定义规范(Data Placeholder Definition, DPD)**

同时，实现了应⽤相应规范⽣成模拟数据的⽅法。

### Faker.js

### YApi

### Apifox
