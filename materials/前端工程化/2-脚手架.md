# 谈谈脚手架

1. 开发⼀个新项⽬时，在进⼊到实际业务编码前，通常需要做很多的基础准备⼯作，这⾥会遇到的问题有：

- 要准备好⼀个项⽬的基础开发设施，需要投⼊⼤量时间和精⼒，这部分的⼯作计量是以天为单位的。

- ⼀个完备的项⽬基础环境就像⼀个精密的仪器，只有各部分都充分协调后才能运转正常。要在较短时间内配置⼀个技术栈完整、辅助功能丰富、兼顾不同环境下构建优化⽬标的项⽬基础代码，通常需要开发⼈员在⼯程领域⻓久的知识储备与实践总结，⽽这对于经验相对较少的开发⼈员⽽⾔是⼀个不⼩的挑战。

- 不同的项⽬需求和团队情况，对应我们在使⽤基础设施时的选择可能也各不相同，因此我们并不能依靠⼀套固定不变的模板，⽽是需要根据不同的现状来使⽤不同的基础设施。这⼜增加了整体时间成本。

2. 脚手架(Scaffold)，解决了这些问题：

- 利⽤脚⼿架⼯具，我们可以经过⼏个简单的选项**快速⽣成**项⽬的基础代码。

- 使⽤脚⼿架⼯具⽣成的项⽬模板通常是经过经验丰富的开发者提炼和检验的，很⼤程度上代表某⼀类项⽬开发的**最佳实践**，相较于让开发者⾃⾏配置提供了更优选择。

- 脚⼿架⼯具也⽀持使⽤**⾃定义模板**，我们也可以根据项⽬中的实际经验总结、定制⼀个脚⼿架模板。

3. 对于⼀个熟练的前端⼯程师来说，要掌握的基本能⼒之⼀就是通过技术选型来确定所需要使⽤的技术栈，然后根据技术栈选择合适的脚⼿架⼯具，来做项⽬代码的初始化。⼀个合适的脚⼿架，可以为开发⼈员提供反复优化后的开发流程配置，⾼效地解决开发中涉及的流程问题，使得⼯程师能够快速上⼿，并提升整个开发流程的效率和体验。

## 脚手架

1. 什么是脚手架？

**脚⼿架（Scaffold）**，原本是建筑⼯程术语，在软件开发领域，脚⼿架是指通过各种⼯具来⽣成项⽬基础代码的技术。

2. 对于⼀个前端项⽬来说，⼀般在进⼊开发之前我们需要做的准备有：

- package.json
- 后选择使⽤ npm 或 Yarn 作为包管理器，添加上对应的 lock ⽂件，来确保在不同环境下部署项⽬时的依赖稳定性。
- 确定项⽬技术栈，团队习惯的技术框架是哪种？使⽤哪⼀种数据流模块？是否使⽤ TypeScript？使⽤哪种 CSS 预处理器？等
- 选择构建工具
- 打通构建流程，通过安装与配置各种 Loader 、插件和其他配置项，来确保开发和⽣产环境能正常构建代码和预览效果。
- 优化构建流程，针对开发/⽣产环境的不同特点进⾏各⾃优化。
- 选择和调试辅助⼯具，例如代码检查⼯具和单元测试⼯具，安装相应依赖并调试配置⽂件。
- 收尾⼯作，检查各主要环节的脚本是否⼯作正常，编写说明⽂档 README.md，将不需要纳⼊版本管理的⽂件⽬录记⼊ .gitignore 等

3. 常用的脚手架：

- Create React App（后简称 CRA ）是 Facebook 官⽅提供的 React 开发⼯具集。

CRA 带来的最⼤的改变，是将⼀个项⽬开发运⾏时的各种配置细节完全封装在了⼀个 react-scripts 依赖包中，这⼤⼤降低了开发者，尤其是对 webpack 等构建⼯具不太熟悉的开发者上⼿开发项⽬的学习成本，也降低了开发者⾃⾏管理各配置依赖包的版本所需的额外测试成本。

- Vue CLI 由 Vue.js 官⽅维护，其定位是 Vue.js 快速开发的完整系统。

Vue CLI ⼯具在设计上吸取了 CRA ⼯具的教训，在保留了创建项⽬开箱即⽤的优点的同时，提供了⽤于覆盖修改原有配置的⾃定义构建配置⽂件和其他⼯具配置⽂件。
同时，在创建项⽬的流程中，Vue CLI 也提供了通过⽤户交互⾃⾏选择的⼀些定制化选项，例如是否集成路由、TypeScript 等，使开发者更有可能依据这些选项来⽣成更适合⾃⼰的初始化项⽬，降低了开发者寻找模板或单独配置的成本。

4. 了解⼀个脚⼿架，除了学会如何使⽤脚⼿架来创建项⽬外，我们还需要了解它提供的具体功能边界，提供了哪些功能、哪些优化。

### 定制一个脚手架模板

1. 在实际开发中，我们还是时常需要对通过这些脚⼿架创建的模板项⽬进⾏定制化，例如：

- 为项⽬引⼊新的通⽤特性
- 针对构建环节的 webpack 配置优化，来提升开发环境的效率和⽣产环境的性能等
- 定制符合团队内部规范的代码检测规则配置。
- 定制单元测试等辅助⼯具模块的配置项。
- 定制符合团队内部规范的⽬录结构与通⽤业务模块，例如业务组件库、辅助⼯具类、⻚⾯模板等。

2. 通过将这些实际项⽬开发中所需要做的定制化修改输出为标准的脚⼿架模板，我们就能在团队内部孵化出更符合团队开发规范的开发流程。⼀⽅⾯最⼤程度减少⼤家在开发中处理重复事务的时间，另⼀⽅⾯也能减少因为开发⻛格不⼀导致的团队内项⽬维护成本的增加。

3. ⼀个最简化的 CRA 模板，模板中包含如下必要⽂件：

- README.md：⽤于在 npm 仓库中显示的模板说明。
- package.json：⽤于描述模板本身的元信息 （例如名称、运⾏脚本、依赖包名和版本等） 。
- template.json：⽤于描述基于模板创建的项⽬中的 package.json 信息。
- template ⽬录：⽤于复制到创建后的项⽬中，**其中 gitignore 在复制后重命名为 .gitignore**，public/index.html 和 src/index 为运⾏ react-scripts 的必要⽂件。
